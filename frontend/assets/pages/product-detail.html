<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Product Details - Digital Garden</title>
    <link rel="stylesheet" href="/frontend/assets/css/style.css" />
    <link rel="stylesheet" href="/frontend/assets/globals.css" />
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="page-wrapper">

        <header class="header">
            <a href="/frontend/assets/pages/home.html">
                <img class="logo" src="/frontend/assets/images/logo.png" alt="Digital Garden Logo" />
            </a>
            <nav class="nav">
                <ul class="nav-list">
                    <li><a href="/frontend/assets/pages/home.html" class="nav-link">Home</a></li>
                    <li><a href="/frontend/assets/pages/shop.html" class="nav-link">Shop</a></li>
                    <li><a href="/frontend/assets/pages/Veggie Plots.html" class="nav-link">Veggie Plots</a></li>
                    <li><a href="/frontend/assets/pages/about.html" class="nav-link">About</a></li>
                    <li><a href="/frontend/assets/pages/contact.html" class="nav-link">Contact</a></li>
                </ul>
            </nav>

            <div class="header-actions">
                <div class="profile-container">
                    <button type="button" class="icon-btn profile-trigger" aria-label="Profile" onclick="toggleProfileMenu()">
                        <div class="icon-inner">
                            <img class="icon-img" src="/frontend/assets/images/profile.png" alt="Profile" />
                        </div>
                    </button>

                    <div class="dropdown-menu" id="profileMenu">
                        <div class="menu-header">
                            <img src="/frontend/assets/images/v41_78.png" alt="User" class="menu-user-img">
                            <span class="menu-username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</span>
                        </div>
                        <hr>
                        <a href="#" class="menu-item">‡∏Å‡∏≤‡∏£‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a>
                        <a href="#" class="menu-item logout">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
                    </div>
                </div>

                <button type="button" class="icon-btn" aria-label="Shop">
                    <div class="icon-inner">
                        <img class="icon-img" src="/frontend/assets/images/shop.png" alt="Shop" />
                    </div>
                </button>
            </div>
        </header>

        <main class="main-content container">

            <section class="product-hero">
                <div class="product-gallery">
                    <div class="main-image">
                        <img id="detailImage" src="" alt="Product Image" style="width:100%; height:100%; object-fit:cover;" />
                    </div>
                    <div class="thumbnail-list">
                        <img src="img/vector-21.svg" class="thumb active" />
                        <img src="img/vector-5.svg" class="thumb" />
                        <img src="img/vector-20.svg" class="thumb" />
                    </div>
                </div>

                <div class="product-info">
                    <h1 id="detailName" class="product-title">Loading...</h1>

                    <p id="detailDesc" class="product-desc">
                        Creating your product content...
                    </p>

                    <div class="product-price-wrapper">
                        <span id="detailPrice" class="price-current">--</span>
                    </div>

                    <div class="product-meta">
                        <div class="quantity-control">
                            <span class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:</span>
                            <div class="quantity-input">
                                <button>-</button>
                                <input type="text" value="1" readonly>
                                <button>+</button>
                            </div>
                        </div>
                        <p class="stock-status">In Stock - Ships in 24 hours</p>
                    </div>

                    <div class="product-actions">
                        <button class="btn btn-primary add-to-cart">
                            <img src="img/vector-7.svg" alt="Cart Icon" />
                            Add to Cart
                        </button>
                        <button class="btn btn-outline wishlist">
                            <img src="img/vector.svg" alt="Heart Icon" />
                        </button>
                    </div>

                    <div class="product-tabs">
                        <div class="tab active" onclick="switchTab('desc')">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div>
                        <div class="tab" onclick="switchTab('reviews')">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß (<span id="reviewCount">0</span>)</div>
                    </div>

                    <div id="content-desc" class="tab-content active">
                        <p id="detailDescFull" class="product-desc-full">
                            </p>
                    </div>

                    <div id="content-reviews" class="tab-content" style="display: none;">
                        <div class="reviews-container">
                            <div class="rating-summary">
                                <div class="big-score" id="avgScore">0.0</div>
                                <div class="stars" id="avgStars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                                <p class="total-reviews-text">‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span id="totalReviewsSummary">0</span> ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</p>
                            </div>

                            <div class="review-list" id="reviewList">
                                </div>

                            <div class="write-review">
                                <h3>‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
                                <form id="reviewForm" onsubmit="submitReview(event)">
                                    <div class="form-group">
                                        <label>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</label>
                                        <select id="userRating" required>
                                            <option value="5">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (5/5)</option>
                                            <option value="4">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ (4/5)</option>
                                            <option value="3">‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ (3/5)</option>
                                            <option value="2">‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ (2/5)</option>
                                            <option value="1">‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ (1/5)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <input type="text" id="userName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" required />
                                    </div>
                                    <div class="form-group">
                                        <textarea id="userComment" placeholder="‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô..." rows="4" required></textarea>
                                    </div>
                                    <button type="submit" class="btn btn-primary">‡∏™‡πà‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="related-products">
                <h2 class="section-title">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à</h2>
                <div class="product-grid" id="relatedGrid">
                    </div>
            </section>

        </main>

        <footer class="footer">
            <div class="footer-container">
                <div class="footer-content">

                    <div class="footer-column footer-brand">
                        <div class="footer-logo">
                            <img src="/frontend/assets/images/logo.png" alt="Digital Garden Logo" />
                        </div>
                        <p class="slogan">
                            Connecting you back to nature, one plant and product at a time.
                        </p>
                    </div>

                    <div class="footer-column">
                        <h4 class="footer-title">Explore</h4>
                        <ul class="footer-list">
                            <li><a href="#">Shop Products</a></li>
                            <li><a href="#">Book a Plot</a></li>
                            <li><a href="#">Our Story</a></li>
                            <li><a href="#">Blog</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4 class="footer-title">Support</h4>
                        <ul class="footer-list">
                            <li><a href="#">Contact Us</a></li>
                            <li><a href="#">FAQs</a></li>
                            <li><a href="#">Shipping & Returns</a></li>
                        </ul>
                    </div>

                    <div class="footer-column">
                        <h4 class="footer-title">Stay Connected</h4>
                        <p class="newsletter-text">
                            Join our newsletter for updates and tips.
                        </p>
                    </div>

                </div>

                <div class="footer-bottom">
                    <p>¬© 2024 Digital Garden. All rights reserved.</p>
                </div>
            </div>
        </footer>

        <button class="chat-button" id="chatButton" aria-label="Toggle Chat">
            <div id="chatIconContainer">
                <img src="/frontend/assets/images/Group.png" alt="Chat Icon" id="chatIconMain" />
            </div>
        </button>

        <div class="chat-popup" id="chatPopup">
            <div class="chat-header">
                <div class="admin-info">
                    <div class="admin-avatar"></div>
                    <div>
                        <p class="admin-name">Greenhearth Admin</p>
                        <p class="admin-status">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
                    </div>
                </div>
                <button class="close-chat-header" id="closeChatHeader">&times;</button>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message admin-msg">
                    ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Digital Garden ‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡πÉ‡∏´‡πâ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?
                </div>
            </div>

            <div class="chat-footer">
                <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." id="chatInput" />
                <button id="sendBtn">
                    <svg viewBox="0 0 24 24" width="24" height="24">
                        <path fill="currentColor" d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
                    </svg>
                </button>
            </div>
        </div>

        <script src="/frontend/assets/js/script.js"></script>

    </div>

    <script src="/frontend/assets/js/products.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏î‡∏∂‡∏á ID ‡∏à‡∏≤‡∏Å URL (‡πÄ‡∏ä‡πà‡∏ô ?id=watering_can)
            const params = new URLSearchParams(window.location.search);
            const productId = params.get('id');

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ products.js ‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (typeof allProducts === 'undefined') {
                console.error("‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå products.js ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠! ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö path ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
                return;
            }

            // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            const product = allProducts[productId];

            if (product) {
                // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
                document.getElementById('detailName').innerText = product.name;
                document.getElementById('detailPrice').innerText = "$" + product.price.toFixed(2);
                document.getElementById('detailDesc').innerText = product.desc;
                document.getElementById('detailImage').src = product.image;
                document.title = product.name + " - Digital Garden"; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ Tab Browser
            } else {
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á ID ‡∏°‡∏≤)
                document.querySelector('.product-info').innerHTML = "<h1>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1><p>‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏≠‡∏≤‡∏à‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß</p><a href='shop.html'>‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>";
                document.querySelector('.main-image').style.display = 'none';
            }
        });
    </script>

    <script>
        // --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≥‡∏•‡∏≠‡∏á (Mock Data) ---
        // ‡∏õ‡∏Å‡∏ï‡∏¥‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å Database ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡∏´‡∏•‡∏≠‡∏Å‡πÜ ‡∏Å‡πà‡∏≠‡∏ô
        let currentReviews = [
            { name: "Somsak Jaidee", rating: 5, comment: "‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö ‡∏™‡πà‡∏á‡πÑ‡∏ß ‡πÅ‡∏û‡πá‡∏Ñ‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ ‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏ä‡πâ‡∏≥‡πÄ‡∏•‡∏¢", date: "2023-10-12" },
            { name: "Jane Doe", rating: 4, comment: "‡∏ä‡∏≠‡∏ö‡∏°‡∏≤‡∏Å‡∏Ñ‡πà‡∏∞ ‡∏™‡∏ß‡∏¢‡∏ï‡∏£‡∏á‡∏õ‡∏Å ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÅ‡∏ô‡∏ö‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢", date: "2023-11-05" },
            { name: "Gardener Pro", rating: 5, comment: "‡πÉ‡∏ä‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å‡∏Ñ‡∏£‡∏±‡∏ö ‡∏î‡∏¥‡∏ô‡∏£‡πà‡∏ß‡∏ô‡∏ã‡∏∏‡∏¢ ‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏ß‡∏°‡∏≤‡∏Å ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏•‡∏¢", date: "2024-01-20" }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            // ‡∏î‡∏∂‡∏á ID ‡∏à‡∏≤‡∏Å URL
            const params = new URLSearchParams(window.location.search);
            const productId = params.get('id');

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö products.js
            if (typeof allProducts === 'undefined') {
                console.error("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• allProducts");
                return;
            }

            const product = allProducts[productId];

            if (product) {
                // --- 2. ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å ---
                document.getElementById('detailName').innerText = product.name;
                document.getElementById('detailPrice').innerText = "$" + product.price.toFixed(2);
                document.getElementById('detailDesc').innerText = product.desc; // ‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠
                // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ö‡∏ö‡∏¢‡∏≤‡∏ß ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ field descDetail ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ä‡πâ desc ‡πÄ‡∏î‡∏¥‡∏°
                document.getElementById('detailDescFull').innerText = product.descDetail || product.desc;
                document.getElementById('detailImage').src = product.image;
                document.title = product.name + " - Digital Garden";

                // --- 3. ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏µ‡∏ß‡∏¥‡∏ß ---
                renderReviews();

                // --- 4. ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° ---
                renderRandomProducts(productId);
            } else {
                document.querySelector('.product-info').innerHTML = "<h1>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1><a href='shop.html'>‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>";
                document.querySelector('.main-image').style.display = 'none';
            }
        });

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Tabs ---
        function switchTab(tabName) {
            // ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));

            // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ tab ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            if (tabName === 'desc') {
                document.getElementById('content-desc').style.display = 'block';
                document.querySelector('.tab:nth-child(1)').classList.add('active');
            } else {
                document.getElementById('content-reviews').style.display = 'block';
                document.querySelector('.tab:nth-child(2)').classList.add('active');
            }
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß ---
        function renderReviews() {
            const list = document.getElementById('reviewList');
            list.innerHTML = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤

            let totalScore = 0;

            // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
            currentReviews.forEach(rev => {
                totalScore += parseInt(rev.rating);
                const stars = "‚òÖ".repeat(rev.rating) + "‚òÜ".repeat(5 - rev.rating);

                const itemHTML = `
                    <div class="review-item">
                        <div class="review-avatar">üë§</div>
                        <div class="review-content">
                            <h4>${rev.name} <span class="review-date">(${rev.date})</span></h4>
                            <div class="review-stars">${stars}</div>
                            <p>${rev.comment}</p>
                        </div>
                    </div>
                `;
                list.innerHTML += itemHTML;
            });

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
            const avg = (totalScore / currentReviews.length).toFixed(1);
            document.getElementById('reviewCount').innerText = currentReviews.length;
            document.getElementById('totalReviewsSummary').innerText = currentReviews.length;
            document.getElementById('avgScore').innerText = isNaN(avg) ? "0.0" : avg;

            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏î‡∏≤‡∏ß‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
            const avgInt = Math.round(avg);
            document.getElementById('avgStars').innerText = "‚òÖ".repeat(avgInt) + "‚òÜ".repeat(5 - avgInt);
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÉ‡∏´‡∏°‡πà ---
        function submitReview(e) {
            e.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä

            const name = document.getElementById('userName').value;
            const rating = parseInt(document.getElementById('userRating').value);
            const comment = document.getElementById('userComment').value;
            const date = new Date().toISOString().split('T')[0];

            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Array
            currentReviews.unshift({ // unshift ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡∏ö‡∏ô‡∏™‡∏∏‡∏î
                name: name,
                rating: rating,
                comment: comment,
                date: date
            });

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡∏ü‡∏≠‡∏£‡πå‡∏°
            renderReviews();
            document.getElementById('reviewForm').reset();
            alert("‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö!");
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏∏‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ ---
        function renderRandomProducts(currentId) {
            const grid = document.getElementById('relatedGrid');

            // 1. ‡πÅ‡∏õ‡∏•‡∏á Object ‡πÄ‡∏õ‡πá‡∏ô Array ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡πà‡∏≤‡∏¢
            let productArray = Object.keys(allProducts).map(key => {
                return {
                    id: key,
                    ...allProducts[key]
                };
            });

            // 2. ‡∏Å‡∏£‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏≠‡∏≠‡∏Å (‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á)
            productArray = productArray.filter(p => p.id !== currentId);

            // 3. ‡∏™‡∏∏‡πà‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö (Shuffle)
            productArray.sort(() => 0.5 - Math.random());

            // 4. ‡∏ï‡∏±‡∏î‡∏°‡∏≤‡πÅ‡∏Ñ‡πà 4 ‡∏ä‡∏¥‡πâ‡∏ô
            const randomItems = productArray.slice(0, 4);

            // 5. ‡∏™‡∏£‡πâ‡∏≤‡∏á HTML
            randomItems.forEach(p => {
                const cardHTML = `
                    <a href="product-detail.html?id=${p.id}" class="product-card">
                        <div class="product-img" style="background-image: url('${p.image}')"></div>
                        <h3 class="card-title">${p.name}</h3>
                        <p class="card-price">$${p.price.toFixed(2)}</p>
                    </a>
                `;
                grid.innerHTML += cardHTML;
            });
        }
    </script>
</body>
</html>